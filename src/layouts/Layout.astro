---
import '../styles/global.css';
import Schema from '../components/Schema.astro';
import TrustBadges from '../components/TrustBadges.astro';
import EmergencyBanner from '../components/EmergencyBanner.astro';
import ContactForm from '../components/ContactForm.astro';
import FloatingCTA from '../components/FloatingCTA.astro';
import LiveChat from '../components/LiveChat.astro';

export interface Props {
	title: string;
	description?: string;
	page?: string;
	service?: string;
}

const { title, description = "Professional roofing services in Overland Park, Kansas. Expert roof repairs, replacements, and storm damage restoration.", page, service } = Astro.props;

// Generate canonical URL based on current page
const baseUrl = "https://overland-park-roofing.vercel.app";
const currentPath = Astro.url.pathname;
const canonicalUrl = `${baseUrl}${currentPath === '/' ? '' : currentPath}`;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Canonical URL for SEO -->
		<link rel="canonical" href={canonicalUrl} />
		
		<title>{title}</title>
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:type" content="website" />
		<meta property="og:url" content={canonicalUrl} />
		
		<!-- Schema.org Structured Data -->
		<Schema page={page} service={service} />
	</head>
	<body>
		<!-- Emergency Hotline Banner -->
		<EmergencyBanner />
		
		<nav class="bg-white shadow-lg sticky top-0 z-40 border-b border-gray-200">
			<div class="max-w-screen-xl mx-auto px-6 md:px-8">
				<div class="flex justify-between h-16">
					<div class="flex items-center">
						<a href="/" class="text-2xl font-bold text-gray-900">Maverick Exteriors</a>
						<span class="ml-2 text-sm text-gray-600">Overland Park</span>
					</div>
					<div class="hidden md:flex items-center space-x-8">
						<a href="/" class="text-gray-900 hover:text-blue-600 transition-colors font-medium">Home</a>
						<a href="/services" class="text-gray-900 hover:text-blue-600 transition-colors font-medium">Services</a>
						<div class="relative group">
							<a href="/service-areas" class="text-gray-900 hover:text-blue-600 transition-colors flex items-center font-medium">
								Locations <span class="ml-1">▼</span>
							</a>
							<div class="absolute top-full left-0 bg-white text-gray-900 shadow-lg rounded-lg mt-1 w-48 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 border border-gray-200">
								<a href="/service-areas" class="block px-4 py-2 hover:bg-gray-50 rounded-t-lg font-semibold">All Service Areas</a>
								<div class="border-t border-gray-200"></div>
								<a href="/locations/overland-park" class="block px-4 py-2 hover:bg-gray-50">Overland Park</a>
								<a href="/locations/kansas-city" class="block px-4 py-2 hover:bg-gray-50">Kansas City</a>
								<a href="/locations/leawood" class="block px-4 py-2 hover:bg-gray-50">Leawood</a>
								<a href="/locations/olathe" class="block px-4 py-2 hover:bg-gray-50">Olathe</a>
								<a href="/locations/shawnee" class="block px-4 py-2 hover:bg-gray-50">Shawnee</a>
								<a href="/locations/lenexa" class="block px-4 py-2 hover:bg-gray-50 rounded-b-lg">Lenexa</a>
							</div>
						</div>
						<a href="/about" class="text-gray-900 hover:text-blue-600 transition-colors font-medium">About</a>
						<a href="/contact" class="text-gray-900 hover:text-blue-600 transition-colors font-medium">Contact</a>
						<a href="tel:913-268-6052" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md font-semibold transition-colors">
							Call (913) 268-6052
						</a>
					</div>
					<div class="md:hidden flex items-center">
						<button id="mobile-menu-button" class="text-gray-900 hover:text-blue-600">
							<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
				</div>
			</div>
			<div id="mobile-menu" class="md:hidden hidden bg-white border-t border-gray-200">
				<div class="px-2 pt-2 pb-3 space-y-1">
					<a href="/" class="block px-3 py-2 hover:bg-gray-50 rounded text-gray-900">Home</a>
					<a href="/services" class="block px-3 py-2 hover:bg-gray-50 rounded text-gray-900">Services</a>
					<a href="/service-areas" class="block px-3 py-2 hover:bg-gray-50 rounded text-gray-900">Service Areas</a>
					<a href="/about" class="block px-3 py-2 hover:bg-gray-50 rounded text-gray-900">About</a>
					<a href="/contact" class="block px-3 py-2 hover:bg-gray-50 rounded text-gray-900">Contact</a>
					<a href="tel:913-268-6052" class="block mx-3 my-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md font-semibold text-center">
						Call (913) 268-6052
					</a>
				</div>
			</div>
		</nav>

		<main>
			<slot />
		</main>

		<!-- Contact Form Section -->
		<div id="contact-form">
			<ContactForm />
		</div>

		<!-- Trust Badges Section -->
		<TrustBadges />

		<footer class="bg-white">
			<div class="max-w-screen-xl mx-auto pt-16 pb-8 px-6 md:px-8 border-t border-gray-200">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-10">
					<!-- Left Section -->
					<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
						<!-- Logo and License -->
						<div class="flex flex-col">
							<a href="/" class="block">
								<h3 class="text-2xl font-bold text-gray-900 mb-4">Maverick Exteriors</h3>
							</a>
							<p class="mt-4 text-gray-600">
								Kansas Contractor License:<br />
								<strong class="font-bold text-gray-900">[License #]</strong>
							</p>
						</div>
						
						<!-- Services -->
						<div class="mt-10 md:mt-0">
							<h3 class="text-sm font-semibold text-gray-900">Services</h3>
							<ul role="list" class="mt-6 list-none pl-0">
								<li class="text-left">
									<a href="/services/emergency-roof-repair" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Emergency Roof Repair
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/services/roof-replacement" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Roof Replacement
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/services/storm-damage-restoration" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Storm Damage Restoration
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/services/gutter-services" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Gutter Services
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/services/siding-services" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Siding Services
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/services" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										View All Services
									</a>
								</li>
							</ul>
						</div>
					</div>
					
					<!-- Right Section -->
					<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
						<!-- Locations -->
						<div>
							<h3 class="text-sm font-semibold text-gray-900">Locations</h3>
							<ul role="list" class="mt-6 list-none pl-0">
								<li class="text-left">
									<a href="/locations/overland-park" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Overland Park, KS
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/locations/kansas-city" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Kansas City, MO
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/locations/leawood" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Leawood, KS
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/locations/olathe" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Olathe, KS
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/locations/shawnee" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										Shawnee, KS
									</a>
								</li>
								<li class="text-left mt-4">
									<a href="/service-areas" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
										View All Locations
									</a>
								</li>
							</ul>
						</div>
						
						<!-- Contact Info -->
						<div class="mt-10 md:mt-0">
							<h3 class="text-sm font-semibold text-gray-900">Contact</h3>
							<div class="mt-6">
								<div class="text-xl font-semibold text-blue-600 mb-4">
									<a href="tel:913-268-6052" class="hover:text-blue-800 transition-colors">(913) 268-6052</a>
								</div>
								<p class="text-sm text-gray-600">
									Serving Kansas City Metro<br />
									Since 1992
								</p>
							</div>
						</div>
					</div>
				</div>
				
				<!-- Bottom Section -->
				<div class="flex flex-col md:flex-row md:items-center md:justify-between border-t border-gray-900/10 mt-8 pt-8">
					<!-- Copyright -->
					<div class="order-1 md:order-1">
						<p class="text-xs text-gray-700 leading-5 mt-8 md:mt-0">
							© 2025 Maverick Exteriors. All rights reserved.
						</p>
					</div>
				</div>
			</div>
		</footer>

		<!-- Floating CTA Buttons -->
		<FloatingCTA />
		
		<!-- Live Chat Widget -->
		<LiveChat />

		<script>
			const mobileMenuButton = document.getElementById('mobile-menu-button');
			const mobileMenu = document.getElementById('mobile-menu');

			mobileMenuButton?.addEventListener('click', () => {
				mobileMenu?.classList.toggle('hidden');
			});
		</script>
		<script type="module">
			import { inject } from '@vercel/analytics';
			inject();
		</script>
	</body>
</html>